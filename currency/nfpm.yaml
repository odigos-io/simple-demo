# ------------------------ Common metadata ------------------------
name: odigos-demo-currency
arch: amd64
platform: linux
version: 1.0.0
section: web
priority: optional
maintainer: Odigos <info@odigos.io>
vendor: Odigos
homepage: https://odigos.io
license: Apache-2.0
description: |
  Demo PHP micro‑service that returns a fake currency conversion
  rate.  Part of the Odigos example stack.

# ------------------------ Cross‑distro runtime deps --------------
depends:
  - php-cli

# ------------------------ Payload ------------------------
contents:
  - src: ./dist/app
    dst: /opt/odigos-demo-currency
  - src: distribution/systemd.service
    dst: /lib/systemd/system/odigos-demo-currency.service

scripts:
  preinstall:  distribution/preinstall.sh
  postinstall: distribution/postinstall.sh
  preremove:   distribution/preremove.sh

# ------------------------ Distro‑specific overrides --------------
overrides:
  rpm:
    # "all" is **not** valid in RPM – the neutral value is "noarch"
    # rpm package names differ
    depends:
      - php-cli
    contents:
      - src: ./dist/app
        dst: /opt/odigos-demo-currency
      - src: distribution/systemd.service
        dst: /lib/systemd/system/odigos-demo-currency.service
    scripts:
      preinstall:  distribution/preinstall.sh
      postinstall: distribution/postinstall-rpm.sh
      preremove:   distribution/preremove-rpm.sh
  deb:
    depends:
      - php-cli (>= 8.2)

